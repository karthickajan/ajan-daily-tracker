â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                               â•‘
â•‘                  RLS POLICIES - ANSWER TO YOUR QUESTION                      â•‘
â•‘                                                                               â•‘
â•‘              "what to write for insert and update ?"                          â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


FOR INSERT - COPY & PASTE THIS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

create policy "allow_insert"
on "public"."tracker_entries"
as PERMISSIVE
for INSERT
to public
with check (true);


FOR UPDATE - COPY & PASTE THIS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

create policy "allow_update"
on "public"."tracker_entries"
as PERMISSIVE
for UPDATE
to public
using (true)
with check (true);


WHAT EACH PART MEANS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

create policy "allow_insert"
  â””â”€ Creates a policy named "allow_insert"

on "public"."tracker_entries"
  â””â”€ Applied to your tracker_entries table

as PERMISSIVE
  â””â”€ PERMISSIVE = Allow access
  â””â”€ (RESTRICTIVE = Deny access)

for INSERT
  â””â”€ This policy is for INSERT operations
  â””â”€ (Can also be: UPDATE, SELECT, DELETE)

to public
  â””â”€ Applies to "public" users (anonymous, no login)

with check (true)
  â””â”€ "true" = Always allow the INSERT
  â””â”€ (Can be a condition like: device_id = 'device_123')

using (true)
  â””â”€ Only in UPDATE/SELECT/DELETE
  â””â”€ "true" = Allow reading rows before modifying them
  â””â”€ (Needed for UPDATE to find rows to update)


POLICY REFERENCE TABLE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Operation  â”‚  Clause        â”‚  Purpose
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
INSERT     â”‚  WITH CHECK    â”‚  Validates data before inserting
UPDATE     â”‚  USING         â”‚  Finds rows to update
UPDATE     â”‚  WITH CHECK    â”‚  Validates new values before updating
SELECT     â”‚  USING         â”‚  Filters which rows are visible
DELETE     â”‚  USING         â”‚  Finds rows that can be deleted


DIFFERENT WITH CHECK CONDITIONS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. ALLOW EVERYTHING (Your case):
   with check (true)
   â””â”€ No conditions, always allow

2. ALLOW BASED ON DEVICE:
   with check (device_id = current_setting('app.current_device_id'))
   â””â”€ Only allow if device_id matches current device
   â””â”€ Requires setting session variables in JavaScript

3. ALLOW BASED ON USER:
   with check (auth.uid() = user_id)
   â””â”€ Only allow if user owns the entry
   â””â”€ Requires authentication

4. ALLOW BASED ON DATE:
   with check (date > now() - interval '1 day')
   â””â”€ Only allow recent entries


COMPLETE POLICY SET FOR YOUR TRACKER
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

If you want all 4 operations (INSERT, UPDATE, SELECT, DELETE):
Copy this entire block and run in Supabase SQL Editor:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ -- Enable Row Level Security                                               â”‚
â”‚ ALTER TABLE public.tracker_entries ENABLE ROW LEVEL SECURITY;              â”‚
â”‚                                                                             â”‚
â”‚ -- Allow INSERT                                                            â”‚
â”‚ CREATE POLICY "allow_insert"                                               â”‚
â”‚ ON public.tracker_entries FOR INSERT                                       â”‚
â”‚ WITH CHECK (true);                                                          â”‚
â”‚                                                                             â”‚
â”‚ -- Allow UPDATE                                                            â”‚
â”‚ CREATE POLICY "allow_update"                                               â”‚
â”‚ ON public.tracker_entries FOR UPDATE                                       â”‚
â”‚ USING (true) WITH CHECK (true);                                            â”‚
â”‚                                                                             â”‚
â”‚ -- Allow SELECT                                                            â”‚
â”‚ CREATE POLICY "allow_select"                                               â”‚
â”‚ ON public.tracker_entries FOR SELECT                                       â”‚
â”‚ USING (true);                                                               â”‚
â”‚                                                                             â”‚
â”‚ -- Allow DELETE                                                            â”‚
â”‚ CREATE POLICY "allow_delete"                                               â”‚
â”‚ ON public.tracker_entries FOR DELETE                                       â”‚
â”‚ USING (true);                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


WHY YOUR TRACKER USES "true"
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Your tracker:
  âœ… Doesn't use login authentication
  âœ… Uses "device_id" to identify users
  âœ… Is personal (just for you)
  âœ… Each entry already includes device_id

So "with check (true)" is perfect because:
  â””â”€ device_id is automatically stored with each entry
  â””â”€ You don't need to restrict at the policy level
  â””â”€ device_id in the data prevents conflicts between devices


COMMON MISTAKES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âŒ MISTAKE: Using INSERT instead of CREATE POLICY
   âœ… CORRECT: CREATE POLICY ... FOR INSERT ...

âŒ MISTAKE: Using WITH CHECK for UPDATE without USING
   âœ… CORRECT: USING (true) WITH CHECK (true)

âŒ MISTAKE: Forgetting to enable RLS
   âœ… CORRECT: ALTER TABLE ... ENABLE ROW LEVEL SECURITY;

âŒ MISTAKE: Using RESTRICTIVE when you mean PERMISSIVE
   âœ… CORRECT: AS PERMISSIVE (to allow) or AS RESTRICTIVE (to deny)


IF YOU GET ERRORS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

"Relation 'public.tracker_entries' does not exist"
  â””â”€ You need to create the table first
  â””â”€ See: SUPABASE_COMPLETE_SETUP.txt â†’ STEP 1

"Policy 'allow_insert' already exists"
  â””â”€ Drop the old policy first:
     DROP POLICY IF EXISTS "allow_insert" ON public.tracker_entries;

"Permission denied for schema public"
  â””â”€ You need to be logged in as project owner
  â””â”€ Check: Top right corner shows your email


NEXT STEPS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. âœ… Copy the INSERT & UPDATE policies above
2. âœ… Go to: https://suxszrvczmdfajekqyrw.supabase.co
3. âœ… Click: SQL Editor â†’ New Query
4. âœ… Paste the policies
5. âœ… Click: Run
6. âœ… Should see: "Success" message
7. âœ… Your tracker is ready!


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    That's all you need to know! ğŸ¯

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
